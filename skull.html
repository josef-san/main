<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BONE - Fixed Sync Speed</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap');

        body {
            background-color: #0a0f0a;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            background-image: 
                linear-gradient(rgba(0, 255, 0, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 0, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            font-family: 'Permanent Marker', cursive;
        }

        #background-pixels {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1; 
            pointer-events: none;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5vw;
            z-index: 10;
        }

        .letter {
            color: #5fff66;
            font-size: clamp(60px, 15vw, 180px);
            text-shadow: 4px 4px 0px #0a2b0c;
            opacity: 0;
            transform: scale(0);
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            user-select: none;
        }

        .letter.visible {
            opacity: 1;
            transform: scale(1);
        }

        .skull-wrapper {
            position: relative;
            width: clamp(80px, 20vw, 180px);
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            flex-shrink: 0;
        }

        #skull-top, #skull-jaw { width: 100%; height: auto; }
        #skull-top { position: relative; z-index: 10; }
        #skull-jaw { position: absolute; top: 75%; left: 50%; transform: translateX(-50%); width: 65%; z-index: 1; }

        #smoke-container {
            position: absolute;
            top: 82%;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            z-index: 11;
            pointer-events: none;
        }

        .pixel-fragment {
            position: absolute;
            border-radius: 0; 
            opacity: 0;
            left: 50%;
            box-shadow: 0 0 8px rgba(95, 255, 102, 0.6);
            border: 1px solid #0a2b0c;
        }

        @keyframes pixelChaosFall {
            0% { transform: translate(0, -20vh) rotate(0deg); opacity: 0; }
            15% { opacity: 0.3; }
            85% { opacity: 0.3; }
            100% { transform: translate(var(--drift), 120vh) rotate(var(--rot)); opacity: 0; }
        }

        @keyframes glitchFloat {
            0% { transform: translate(-50%, 20px) scale(0); opacity: 0; }
            10% { opacity: 1; }
            100% { transform: translate(calc(-50% + var(--rand-x) * 1px), -100px) scale(1.5); opacity: 0; }
        }

        @keyframes glitchEruption {
            0% { transform: translate(-50%, 20px) scale(0); opacity: 0; }
            15% { opacity: 1; filter: brightness(1.5); }
            30% { transform: translate(calc(-50% + var(--rand-x) * 1.4px), 30px) scale(2); }
            100% { transform: translate(calc(-50% + var(--rand-x) * 1.8px), -500px) scale(0.2); opacity: 0; }
        }
    </style>
</head>
<body>

    <div id="background-pixels"></div>

    <div class="logo-container">
        <span class="letter">B</span>
        <div class="skull-wrapper" id="main-skull">
            <img src="horni_cast.png" id="skull-top">
            <div id="smoke-container"></div>
            <img src="celist.png" id="skull-jaw">
        </div>
        <span class="letter">N</span>
        <span class="letter">E</span>
    </div>

    <script>
        // --- INTERAKCE ---
        const skullBtn = document.getElementById('main-skull');
        const letters = document.querySelectorAll('.letter');
        let isTextVisible = false;

        skullBtn.addEventListener('click', () => {
            isTextVisible = !isTextVisible;
            letters.forEach((l, index) => {
                setTimeout(() => {
                    l.classList.toggle('visible', isTextVisible);
                }, index * 100);
            });
        });

        // --- PADAJÍCÍ KOSTKY ---
        const bgPixelsContainer = document.getElementById('background-pixels');
        function createBackgroundPixel() {
            const pixel = document.createElement('div');
            pixel.style.position = 'absolute';
            const size = Math.random() * (window.innerWidth < 600 ? 35 : 65) + 5; 
            pixel.style.width = pixel.style.height = size + 'px';
            pixel.style.left = Math.random() * 100 + 'vw';
            pixel.style.top = '-100px';
            pixel.style.backgroundColor = ['#4df052', '#86ff8a', '#0a2b0c', '#ffffff'][Math.floor(Math.random() * 4)];
            pixel.style.opacity = '0.3';
            const drift = (Math.random() - 0.5) * (window.innerWidth * 0.5) + 'px';
            const rotation = Math.random() * 720 + 'deg';
            pixel.style.setProperty('--drift', drift);
            pixel.style.setProperty('--rot', rotation);
            const duration = Math.random() * 5 + 4;
            pixel.style.animation = `pixelChaosFall ${duration}s linear forwards`;
            bgPixelsContainer.appendChild(pixel);
            setTimeout(() => pixel.remove(), duration * 1000);
        }
        setInterval(createBackgroundPixel, 200);

        // --- OPRAVENÁ ANIMACE (TIME-BASED) ---
        const jaw = document.getElementById('skull-jaw');
        const topPart = document.getElementById('skull-top');
        const smokeContainer = document.getElementById('smoke-container');
        
        let angle = 0;
        let cycleCount = 0;
        let hasExhaledThisCycle = false;
        let lastTime = 0;

        function createPixel(isExplosion = false) {
            const pixel = document.createElement('div');
            pixel.classList.add('pixel-fragment');
            const size = isExplosion ? (Math.random() * 20 + 5) : (Math.random() * 10 + 4);
            pixel.style.width = pixel.style.height = `${size}px`;
            const duration = isExplosion ? (Math.random() * 0.6 + 0.8) : (Math.random() * 1.8 + 1.2);
            pixel.style.animation = `${isExplosion ? 'glitchEruption' : 'glitchFloat'} ${duration}s steps(20, end) forwards`;
            const randX = (Math.random() - 0.5) * (isExplosion ? 340 : 120);
            pixel.style.setProperty('--rand-x', randX);
            pixel.style.backgroundColor = isExplosion ? ['#5fff66', '#ffffff', '#bdff00'][Math.floor(Math.random()*3)] : ['#4df052', '#86ff8a', '#00ff41'][Math.floor(Math.random()*3)];
            pixel.style.zIndex = "11";
            smokeContainer.appendChild(pixel);
            setTimeout(() => pixel.remove(), duration * 1000);
        }

        setInterval(() => createPixel(false), 120);

        function animate(currentTime) {
            if (!lastTime) lastTime = currentTime;
            const deltaTime = (currentTime - lastTime) / 16.66; // Normalizace na 60 FPS
            lastTime = currentTime;

            let prevSin = Math.sin(angle);
            // Původní hodnota 0.0090 se teď násobí deltaTime pro srovnání rychlosti
            angle += 0.05 * deltaTime; 
            let currentSin = Math.sin(angle);

            if (prevSin > 0 && currentSin <= 0) {
                cycleCount++;
                hasExhaledThisCycle = false;
            }

            if (cycleCount % 2 === 0 && currentSin > 0.7 && !hasExhaledThisCycle) {
                for (let i = 0; i < 55; i++) setTimeout(() => createPixel(true), i * 7);
                hasExhaledThisCycle = true;
            }

            const moveJaw = (currentSin + 1) * 2; 
            jaw.style.transform = `translateX(-50%) translateY(${moveJaw}px)`;
            topPart.style.transform = `translateY(${currentSin * -3}px)`;
            smokeContainer.style.transform = `translateX(-50%) translateY(${moveJaw * 0.7}px)`;

            requestAnimationFrame(animate);
        }

        requestAnimationFrame(animate);
    </script>
</body>
</html>
